#pragma once
string g_csvFileName="TradeSetups.csv";
void InitCSVLogger(){int h=FileOpen(g_csvFileName,FILE_READ|FILE_TXT);if(h==INVALID_HANDLE){h=FileOpen(g_csvFileName,FILE_WRITE|FILE_TXT);if(h!=INVALID_HANDLE){FileWrite(h,"Timestamp;Symbol;Type;Entry;SL;TP;RiskPts;ExpUSD;OB_High;OB_Low;OB_AgeBars;FVG_GapPts;VolRatio;ATR_LTF;ATR_MTF;ATR_HTF;KellyRiskPercent");FileClose(h);}}else FileClose(h);}
void LogTradeSetup(const string symbol,const string type,double entry,double sl,double tp,double riskPts,double expUSD,double obHigh,double obLow,int obAgeBars,double fvgGapPts,double volRatio,double atrLTF,double atrMTF,double atrHTF,double kellyRiskPercent){int h=FileOpen(g_csvFileName,FILE_READ|FILE_WRITE|FILE_TXT);if(h==INVALID_HANDLE){Print("CSV logger open failed");return;}FileSeek(h,0,SEEK_END);string line=TimeToString(TimeCurrent(),TIME_DATE|TIME_SECONDS)+";"+symbol+";"+type+";"+DoubleToString(entry,Digits())+";"+DoubleToString(sl,Digits())+";"+DoubleToString(tp,Digits())+";"+DoubleToString(riskPts,2)+";"+DoubleToString(expUSD,2)+";"+DoubleToString(obHigh,Digits())+";"+DoubleToString(obLow,Digits())+";"+IntegerToString(obAgeBars)+";"+DoubleToString(fvgGapPts,2)+";"+DoubleToString(volRatio,2)+";"+DoubleToString(atrLTF,2)+";"+DoubleToString(atrMTF,2)+";"+DoubleToString(atrHTF,2)+";"+DoubleToString(kellyRiskPercent,3);FileWrite(h,line);FileClose(h);}